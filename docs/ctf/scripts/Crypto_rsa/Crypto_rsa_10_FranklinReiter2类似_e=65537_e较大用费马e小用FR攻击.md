题目
```python
import libnum
import gmpy2
import uuid
from Crypto.Util.number import *
flag = "flag{" + str(uuid.uuid4()) + "}"
m = libnum.s2n(flag)

e = 65537
p = getPrime(1024)
q = getPrime(1024)
n = p * q
c = pow(m, e, n)
hint = pow(2020 * p + 2021, q, n)
print(f'n={n}')
print(f'c={c}')
print(f'hint={hint}')
n=27020725261160598541077357737650775795182555998856810737571508044949928734067444441660366270392732456051807439301564552672200975582350577967001486740668193835704559129378410828266554536148151615878808327988333060924165410762016082268322936465413880236634083213834739549234631742766416876749808978934944262651307600621868854944164060642189749365967978497831698002669974744487926082412272998646851047638183126945784060957075393737537570645086672473571281053798891685646561828588448040073373363454584468753860529849749093081434144360661566815886630699933232263079413562069476421802192735693386029862725050469209845710383
c=10188807385387617708190575473905502994151677148079820873886980571555051900701810208218351138721306416600688313703084580808183634201231599134123549448962443376514560489130860694363901933597676373555599555647232128717993571185822894818704143675318690577221330618533739592165564396729937983659337232822442555504262694675199751730664450120569727835850996566436129543730932040989365233424791093843941154003052950306359994891955336607690065213304872738280674213630736611351982705373394299097653653497017756036211550125607093109216729483090391729134062236908282557149575812220142872855836932590459512028618076264332235518829
hint=15179972145975733285419381814235528011288991423484121653543845156913121513320504879647666067298415751234264897435338898933073713420024176276221164394369781676781604128149168834126855517212300158864797800121336042194751965268493010327202598446572764475343894613152062609436699715193914479572113800212525965140106015838636914979735618606768207651697548364440806425770871133439416876157686985836939255598747973339866125864303982956813846287509191028829738926404992619459242904729015823730553526572575372668559669124599614613391797015393641171177282129497503752370800088634017972208535899870704612274473042064675033593148
```


推导p
$$
\begin{multline}
\shoveleft
\begin{aligned}
    & h = (2020*p+2021)^q \% n \\
    & h = (2020*p+2021)^q + kn \\
    & h = k_2p+2021^q + k_1pq \\
    & h\%p = 2021^q\%p \\
    & 2021^q -h = kp \\
    & p = gcd(2021^q-h, n)\\
\end{aligned}
\end{multline}
$$
q未知，推导消q
$$
\begin{multline}
\shoveleft
\begin{aligned}
    & h\%p = 2021^q\%p\\
    & 证明 \ 2021^q\%p = 2021^n\%p \\
    & 2021^n\%p = 2021^{p*q}\%p \\
    & 2021^n\%p = (2021^q)^p\%p \\
    & 费马小定理 a^p \equiv a(mod\ p) \\
    & 2021^n\%p = (2021^q)\%p \\
    & h\%p = 2021^n\%p \\
    & p = gcd(2021^n\%n-h, n)\\
    
\end{aligned}
\end{multline}
$$